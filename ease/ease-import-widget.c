/* ease-import-widget.c generated by valac 0.10.0, the Vala compiler
 * generated from ease-import-widget.vala, do not modify */

/*  Ease, a GTK presentation application
    Copyright (C) 2010 Nate Stedman

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/

#include <glib.h>
#include <glib-object.h>
#include <gtk/gtk.h>
#include <ease-core.h>
#include <stdlib.h>
#include <string.h>
#include <float.h>
#include <math.h>
#include <gdk/gdk.h>
#include <gee.h>


#define EASE_TYPE_IMPORT_WIDGET (ease_import_widget_get_type ())
#define EASE_IMPORT_WIDGET(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), EASE_TYPE_IMPORT_WIDGET, EaseImportWidget))
#define EASE_IMPORT_WIDGET_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), EASE_TYPE_IMPORT_WIDGET, EaseImportWidgetClass))
#define EASE_IS_IMPORT_WIDGET(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), EASE_TYPE_IMPORT_WIDGET))
#define EASE_IS_IMPORT_WIDGET_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), EASE_TYPE_IMPORT_WIDGET))
#define EASE_IMPORT_WIDGET_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), EASE_TYPE_IMPORT_WIDGET, EaseImportWidgetClass))

typedef struct _EaseImportWidget EaseImportWidget;
typedef struct _EaseImportWidgetClass EaseImportWidgetClass;
typedef struct _EaseImportWidgetPrivate EaseImportWidgetPrivate;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
typedef struct _Block5Data Block5Data;
#define __g_list_free_gtk_tree_path_free0(var) ((var == NULL) ? NULL : (var = (_g_list_free_gtk_tree_path_free (var), NULL)))

struct _EaseImportWidget {
	GtkAlignment parent_instance;
	EaseImportWidgetPrivate * priv;
	GtkIconView* icons;
	GtkWidget* icons_container;
	GtkEntry* search;
	GtkButton* button;
	GtkButton* insert;
	GtkProgressBar* progress;
	GtkSpinner* spinner;
	GtkWidget* spinner_container;
	GtkWidget* no_results;
	GtkWidget* extra_widget;
};

struct _EaseImportWidgetClass {
	GtkAlignmentClass parent_class;
};

struct _EaseImportWidgetPrivate {
	EasePluginImportService* service;
};

struct _Block5Data {
	int _ref_count_;
	EaseImportWidget * self;
	GtkTreeModel* model;
	GtkTreeIter iter;
	EasePluginImportMedia* media;
	GeeLinkedList* list;
};


static gpointer ease_import_widget_parent_class = NULL;

GType ease_import_widget_get_type (void) G_GNUC_CONST;
#define EASE_IMPORT_WIDGET_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), EASE_TYPE_IMPORT_WIDGET, EaseImportWidgetPrivate))
enum  {
	EASE_IMPORT_WIDGET_DUMMY_PROPERTY
};
#define EASE_IMPORT_WIDGET_UI_FILE_PATH "import-widget.ui"
#define EASE_IMPORT_WIDGET_DARK_FACTOR 1.1
#define EASE_IMPORT_WIDGET_SPINNER_SIZE 40
EaseImportWidget* ease_import_widget_new (EasePluginImportService* serv);
EaseImportWidget* ease_import_widget_construct (GType object_type, EasePluginImportService* serv);
static gboolean _lambda71_ (GtkWidget* _self_, GdkEvent* event, EaseImportWidget* self);
static gboolean __lambda71__gtk_widget_map_event (GtkWidget* _sender, GdkEvent* event, gpointer self);
static void _lambda72_ (EaseImportWidget* self);
static void __lambda72__gtk_entry_icon_press (GtkEntry* _sender, GtkEntryIconPosition p0, GdkEvent* p1, gpointer self);
static void _lambda73_ (EaseImportWidget* self);
static void __lambda73__gtk_entry_activate (GtkEntry* _sender, gpointer self);
static gboolean ease_import_widget_set_bg (EaseImportWidget* self, GtkWidget* root, GdkEventExpose* event);
static gboolean _ease_import_widget_set_bg_gtk_widget_expose_event (GtkWidget* _sender, GdkEventExpose* event, gpointer self);
static void _lambda74_ (EaseImportWidget* self);
static void __lambda74__gtk_button_clicked (GtkButton* _sender, gpointer self);
static void _lambda75_ (EaseImportWidget* self);
static void _lambda76_ (GtkIconView* view, GtkTreePath* path, Block5Data* _data5_);
static void __lambda76__gtk_icon_view_foreach_func (GtkIconView* icon_view, GtkTreePath* path, gpointer self);
static Block5Data* block5_data_ref (Block5Data* _data5_);
static void block5_data_unref (Block5Data* _data5_);
static void __lambda75__gtk_button_clicked (GtkButton* _sender, gpointer self);
static void _lambda77_ (EaseImportWidget* self);
static void _g_list_free_gtk_tree_path_free (GList* self);
static void __lambda77__gtk_icon_view_selection_changed (GtkIconView* _sender, gpointer self);
static void _lambda78_ (EaseImportWidget* self);
static void __lambda78__ease_plugin_import_service_started (EasePluginImportService* _sender, gpointer self);
static void _lambda79_ (EaseImportWidget* self);
static void __lambda79__ease_plugin_import_service_proxy_call_complete (EasePluginImportService* _sender, gpointer self);
static void _lambda80_ (EaseImportWidget* self);
static void __lambda80__ease_plugin_import_service_no_results (EasePluginImportService* _sender, gpointer self);
static GtkIconView* _lambda81_ (EaseImportWidget* self);
static GtkIconView* __lambda81__ease_plugin_import_service_loading_started (EasePluginImportService* _sender, gpointer self);
static void _lambda82_ (double fraction, EaseImportWidget* self);
static void __lambda82__ease_plugin_import_service_loading_progress (EasePluginImportService* _sender, double progress, gpointer self);
static void _lambda83_ (EaseImportWidget* self);
static void __lambda83__ease_plugin_import_service_loading_complete (EasePluginImportService* _sender, gpointer self);
static void ease_import_widget_finalize (GObject* obj);



static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


#line 94 "ease-import-widget.vala"
static gboolean _lambda71_ (GtkWidget* _self_, GdkEvent* event, EaseImportWidget* self) {
#line 137 "ease-import-widget.c"
	gboolean result = FALSE;
	GdkColor color;
#line 94 "ease-import-widget.vala"
	g_return_val_if_fail (_self_ != NULL, FALSE);
#line 94 "ease-import-widget.vala"
	g_return_val_if_fail (event != NULL, FALSE);
#line 95 "ease-import-widget.vala"
	color = gtk_widget_get_style ((GtkWidget*) self)->bg[GTK_STATE_NORMAL];
#line 96 "ease-import-widget.vala"
	color.red = (guint16) 0;
#line 97 "ease-import-widget.vala"
	gtk_widget_modify_bg ((GtkWidget*) self, GTK_STATE_NORMAL, &color);
#line 150 "ease-import-widget.c"
	result = FALSE;
#line 98 "ease-import-widget.vala"
	return result;
#line 154 "ease-import-widget.c"
}


#line 94 "ease-import-widget.vala"
static gboolean __lambda71__gtk_widget_map_event (GtkWidget* _sender, GdkEvent* event, gpointer self) {
#line 160 "ease-import-widget.c"
	gboolean result;
	result = _lambda71_ (_sender, event, self);
	return result;
}


#line 122 "ease-import-widget.vala"
static void _lambda72_ (EaseImportWidget* self) {
#line 122 "ease-import-widget.vala"
	gtk_entry_set_text (self->search, "");
#line 171 "ease-import-widget.c"
}


#line 122 "ease-import-widget.vala"
static void __lambda72__gtk_entry_icon_press (GtkEntry* _sender, GtkEntryIconPosition p0, GdkEvent* p1, gpointer self) {
#line 177 "ease-import-widget.c"
	_lambda72_ (self);
}


#line 123 "ease-import-widget.vala"
static void _lambda73_ (EaseImportWidget* self) {
#line 123 "ease-import-widget.vala"
	g_signal_emit_by_name (self->button, "activate");
#line 186 "ease-import-widget.c"
}


#line 123 "ease-import-widget.vala"
static void __lambda73__gtk_entry_activate (GtkEntry* _sender, gpointer self) {
#line 192 "ease-import-widget.c"
	_lambda73_ (self);
}


#line 216 "ease-import-widget.vala"
static gboolean _ease_import_widget_set_bg_gtk_widget_expose_event (GtkWidget* _sender, GdkEventExpose* event, gpointer self) {
#line 199 "ease-import-widget.c"
	gboolean result;
	result = ease_import_widget_set_bg (self, _sender, event);
	return result;
}


#line 128 "ease-import-widget.vala"
static void _lambda74_ (EaseImportWidget* self) {
#line 128 "ease-import-widget.vala"
	ease_plugin_import_service_run (self->priv->service, gtk_entry_get_text (self->search));
#line 210 "ease-import-widget.c"
}


#line 128 "ease-import-widget.vala"
static void __lambda74__gtk_button_clicked (GtkButton* _sender, gpointer self) {
#line 216 "ease-import-widget.c"
	_lambda74_ (self);
}


#line 138 "ease-import-widget.vala"
static void _lambda76_ (GtkIconView* view, GtkTreePath* path, Block5Data* _data5_) {
#line 223 "ease-import-widget.c"
	EaseImportWidget * self;
	self = _data5_->self;
#line 138 "ease-import-widget.vala"
	g_return_if_fail (view != NULL);
#line 138 "ease-import-widget.vala"
	g_return_if_fail (path != NULL);
#line 139 "ease-import-widget.vala"
	gtk_tree_model_get_iter (_data5_->model, &_data5_->iter, path);
#line 140 "ease-import-widget.vala"
	gtk_tree_model_get (_data5_->model, &_data5_->iter, EASE_PLUGIN_IMPORT_SERVICE_COLUMN_IMPORT_MEDIA, &_data5_->media, -1);
#line 142 "ease-import-widget.vala"
	gee_abstract_collection_add ((GeeAbstractCollection*) _data5_->list, _data5_->media);
#line 236 "ease-import-widget.c"
}


#line 138 "ease-import-widget.vala"
static void __lambda76__gtk_icon_view_foreach_func (GtkIconView* icon_view, GtkTreePath* path, gpointer self) {
#line 242 "ease-import-widget.c"
	_lambda76_ (icon_view, path, self);
}


static Block5Data* block5_data_ref (Block5Data* _data5_) {
	g_atomic_int_inc (&_data5_->_ref_count_);
	return _data5_;
}


static void block5_data_unref (Block5Data* _data5_) {
	if (g_atomic_int_dec_and_test (&_data5_->_ref_count_)) {
		_g_object_unref0 (_data5_->self);
		_g_object_unref0 (_data5_->list);
		_g_object_unref0 (_data5_->media);
		_g_object_unref0 (_data5_->model);
		g_slice_free (Block5Data, _data5_);
	}
}


#line 133 "ease-import-widget.vala"
static void _lambda75_ (EaseImportWidget* self) {
#line 266 "ease-import-widget.c"
	Block5Data* _data5_;
	_data5_ = g_slice_new0 (Block5Data);
	_data5_->_ref_count_ = 1;
	_data5_->self = g_object_ref (self);
	_data5_->model = _g_object_ref0 (gtk_icon_view_get_model (self->icons));
	memset (&_data5_->iter, 0, sizeof (GtkTreeIter));
	_data5_->media = NULL;
	_data5_->list = gee_linked_list_new (EASE_PLUGIN_TYPE_IMPORT_MEDIA, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL);
#line 138 "ease-import-widget.vala"
	gtk_icon_view_selected_foreach (self->icons, __lambda76__gtk_icon_view_foreach_func, _data5_);
#line 144 "ease-import-widget.vala"
	g_signal_emit_by_name (self, "add-media", (GeeQueue*) _data5_->list);
#line 279 "ease-import-widget.c"
	block5_data_unref (_data5_);
}


#line 133 "ease-import-widget.vala"
static void __lambda75__gtk_button_clicked (GtkButton* _sender, gpointer self) {
#line 286 "ease-import-widget.c"
	_lambda75_ (self);
}


static void _g_list_free_gtk_tree_path_free (GList* self) {
	g_list_foreach (self, (GFunc) gtk_tree_path_free, NULL);
	g_list_free (self);
}


#line 161 "ease-import-widget.vala"
static void _lambda77_ (EaseImportWidget* self) {
#line 299 "ease-import-widget.c"
	GList* _tmp0_;
#line 162 "ease-import-widget.vala"
	gtk_widget_set_sensitive ((GtkWidget*) self->insert, g_list_length (_tmp0_ = gtk_icon_view_get_selected_items (self->icons)) > 0);
#line 303 "ease-import-widget.c"
	__g_list_free_gtk_tree_path_free0 (_tmp0_);
}


#line 161 "ease-import-widget.vala"
static void __lambda77__gtk_icon_view_selection_changed (GtkIconView* _sender, gpointer self) {
#line 310 "ease-import-widget.c"
	_lambda77_ (self);
}


#line 174 "ease-import-widget.vala"
static void _lambda78_ (EaseImportWidget* self) {
#line 176 "ease-import-widget.vala"
	gtk_widget_set_visible (self->icons_container, FALSE);
#line 177 "ease-import-widget.vala"
	gtk_widget_set_visible (self->no_results, FALSE);
#line 180 "ease-import-widget.vala"
	gtk_spinner_start (self->spinner);
#line 181 "ease-import-widget.vala"
	gtk_widget_set_visible (self->spinner_container, TRUE);
#line 184 "ease-import-widget.vala"
	gtk_progress_bar_set_fraction (self->progress, (double) 0);
#line 327 "ease-import-widget.c"
}


#line 174 "ease-import-widget.vala"
static void __lambda78__ease_plugin_import_service_started (EasePluginImportService* _sender, gpointer self) {
#line 333 "ease-import-widget.c"
	_lambda78_ (self);
}


#line 187 "ease-import-widget.vala"
static void _lambda79_ (EaseImportWidget* self) {
#line 189 "ease-import-widget.vala"
	gtk_widget_set_visible (self->spinner_container, FALSE);
#line 190 "ease-import-widget.vala"
	gtk_spinner_stop (self->spinner);
#line 344 "ease-import-widget.c"
}


#line 187 "ease-import-widget.vala"
static void __lambda79__ease_plugin_import_service_proxy_call_complete (EasePluginImportService* _sender, gpointer self) {
#line 350 "ease-import-widget.c"
	_lambda79_ (self);
}


#line 193 "ease-import-widget.vala"
static void _lambda80_ (EaseImportWidget* self) {
#line 194 "ease-import-widget.vala"
	gtk_widget_set_visible (self->no_results, TRUE);
#line 359 "ease-import-widget.c"
}


#line 193 "ease-import-widget.vala"
static void __lambda80__ease_plugin_import_service_no_results (EasePluginImportService* _sender, gpointer self) {
#line 365 "ease-import-widget.c"
	_lambda80_ (self);
}


#line 197 "ease-import-widget.vala"
static GtkIconView* _lambda81_ (EaseImportWidget* self) {
#line 372 "ease-import-widget.c"
	GtkIconView* result = NULL;
#line 199 "ease-import-widget.vala"
	gtk_widget_set_visible (self->icons_container, TRUE);
#line 202 "ease-import-widget.vala"
	gtk_widget_set_visible ((GtkWidget*) self->progress, TRUE);
#line 378 "ease-import-widget.c"
	result = _g_object_ref0 (self->icons);
#line 204 "ease-import-widget.vala"
	return result;
#line 382 "ease-import-widget.c"
}


#line 197 "ease-import-widget.vala"
static GtkIconView* __lambda81__ease_plugin_import_service_loading_started (EasePluginImportService* _sender, gpointer self) {
#line 388 "ease-import-widget.c"
	GtkIconView* result;
	result = _lambda81_ (self);
	return result;
}


#line 207 "ease-import-widget.vala"
static void _lambda82_ (double fraction, EaseImportWidget* self) {
#line 208 "ease-import-widget.vala"
	gtk_progress_bar_set_fraction (self->progress, fraction);
#line 399 "ease-import-widget.c"
}


#line 207 "ease-import-widget.vala"
static void __lambda82__ease_plugin_import_service_loading_progress (EasePluginImportService* _sender, double progress, gpointer self) {
#line 405 "ease-import-widget.c"
	_lambda82_ (progress, self);
}


#line 211 "ease-import-widget.vala"
static void _lambda83_ (EaseImportWidget* self) {
#line 212 "ease-import-widget.vala"
	gtk_widget_set_visible ((GtkWidget*) self->progress, FALSE);
#line 414 "ease-import-widget.c"
}


#line 211 "ease-import-widget.vala"
static void __lambda83__ease_plugin_import_service_loading_complete (EasePluginImportService* _sender, gpointer self) {
#line 420 "ease-import-widget.c"
	_lambda83_ (self);
}


#line 88 "ease-import-widget.vala"
EaseImportWidget* ease_import_widget_construct (GType object_type, EasePluginImportService* serv) {
#line 427 "ease-import-widget.c"
	EaseImportWidget * self;
	EasePluginImportService* _tmp0_;
	GtkBuilder* builder;
	GtkWidget* _tmp3_;
	GObject* _tmp5_;
	GtkEntry* _tmp6_;
	GObject* _tmp7_;
	GtkButton* _tmp8_;
	GObject* _tmp9_;
	GtkButton* _tmp10_;
	GObject* _tmp11_;
	GtkProgressBar* _tmp12_;
	GtkSpinner* _tmp13_;
	GObject* _tmp14_;
	GtkWidget* _tmp15_;
	GtkWidget* _tmp16_;
	GObject* _tmp17_;
	GtkIconView* _tmp18_;
	GObject* _tmp19_;
	GtkWidget* _tmp20_;
	GObject* _tmp21_;
	GtkWidget* _tmp22_;
	GObject* _tmp23_;
	GtkEventBox* root;
	GError * _inner_error_ = NULL;
#line 88 "ease-import-widget.vala"
	g_return_val_if_fail (serv != NULL, NULL);
#line 455 "ease-import-widget.c"
	self = g_object_newv (object_type, 0, NULL);
#line 90 "ease-import-widget.vala"
	self->priv->service = (_tmp0_ = _g_object_ref0 (serv), _g_object_unref0 (self->priv->service), _tmp0_);
#line 91 "ease-import-widget.vala"
	gtk_alignment_set_padding ((GtkAlignment*) self, (guint) 0, (guint) 0, (guint) 0, (guint) 0);
#line 94 "ease-import-widget.vala"
	g_signal_connect_object ((GtkWidget*) self, "map-event", (GCallback) __lambda71__gtk_widget_map_event, self, 0);
#line 102 "ease-import-widget.vala"
	builder = gtk_builder_new ();
#line 465 "ease-import-widget.c"
	{
		char* _tmp1_;
		char* _tmp2_;
#line 105 "ease-import-widget.vala"
		gtk_builder_add_from_file (builder, _tmp2_ = ease_data_path (_tmp1_ = g_build_filename (EASE_TEMP_UI_DIR, EASE_IMPORT_WIDGET_UI_FILE_PATH, NULL)), &_inner_error_);
#line 471 "ease-import-widget.c"
		_g_free0 (_tmp2_);
		_g_free0 (_tmp1_);
		if (_inner_error_ != NULL) {
			goto __catch9_g_error;
		}
	}
	goto __finally9;
	__catch9_g_error:
	{
		GError * e;
		e = _inner_error_;
		_inner_error_ = NULL;
		{
#line 108 "ease-import-widget.vala"
			g_error ("ease-import-widget.vala:108: Error loading UI: %s", e->message);
#line 487 "ease-import-widget.c"
			_g_error_free0 (e);
		}
	}
	__finally9:
	if (_inner_error_ != NULL) {
		_g_object_unref0 (builder);
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return NULL;
	}
#line 111 "ease-import-widget.vala"
	self->extra_widget = (_tmp3_ = ease_plugin_import_service_extra_widget (self->priv->service), _g_object_unref0 (self->extra_widget), _tmp3_);
#line 112 "ease-import-widget.vala"
	if (self->extra_widget != NULL) {
#line 502 "ease-import-widget.c"
		GObject* _tmp4_;
#line 115 "ease-import-widget.vala"
		gtk_widget_show_all (self->extra_widget);
#line 116 "ease-import-widget.vala"
		gtk_container_add ((GtkContainer*) (_tmp4_ = gtk_builder_get_object (builder, "extra-alignment"), GTK_IS_ALIGNMENT (_tmp4_) ? ((GtkAlignment*) _tmp4_) : NULL), self->extra_widget);
#line 508 "ease-import-widget.c"
	}
#line 121 "ease-import-widget.vala"
	self->search = (_tmp6_ = _g_object_ref0 ((_tmp5_ = gtk_builder_get_object (builder, "search"), GTK_IS_ENTRY (_tmp5_) ? ((GtkEntry*) _tmp5_) : NULL)), _g_object_unref0 (self->search), _tmp6_);
#line 122 "ease-import-widget.vala"
	g_signal_connect_object (self->search, "icon-press", (GCallback) __lambda72__gtk_entry_icon_press, self, 0);
#line 123 "ease-import-widget.vala"
	g_signal_connect_object (self->search, "activate", (GCallback) __lambda73__gtk_entry_activate, self, 0);
#line 124 "ease-import-widget.vala"
	g_signal_connect_object ((GtkWidget*) self->search, "expose-event", (GCallback) _ease_import_widget_set_bg_gtk_widget_expose_event, self, 0);
#line 127 "ease-import-widget.vala"
	self->button = (_tmp8_ = _g_object_ref0 ((_tmp7_ = gtk_builder_get_object (builder, "search-button"), GTK_IS_BUTTON (_tmp7_) ? ((GtkButton*) _tmp7_) : NULL)), _g_object_unref0 (self->button), _tmp8_);
#line 128 "ease-import-widget.vala"
	g_signal_connect_object (self->button, "clicked", (GCallback) __lambda74__gtk_button_clicked, self, 0);
#line 129 "ease-import-widget.vala"
	g_signal_connect_object ((GtkWidget*) self->button, "expose-event", (GCallback) _ease_import_widget_set_bg_gtk_widget_expose_event, self, 0);
#line 132 "ease-import-widget.vala"
	self->insert = (_tmp10_ = _g_object_ref0 ((_tmp9_ = gtk_builder_get_object (builder, "insert"), GTK_IS_BUTTON (_tmp9_) ? ((GtkButton*) _tmp9_) : NULL)), _g_object_unref0 (self->insert), _tmp10_);
#line 133 "ease-import-widget.vala"
	g_signal_connect_object (self->insert, "clicked", (GCallback) __lambda75__gtk_button_clicked, self, 0);
#line 146 "ease-import-widget.vala"
	g_signal_connect_object ((GtkWidget*) self->insert, "expose-event", (GCallback) _ease_import_widget_set_bg_gtk_widget_expose_event, self, 0);
#line 149 "ease-import-widget.vala"
	self->progress = (_tmp12_ = _g_object_ref0 ((_tmp11_ = gtk_builder_get_object (builder, "progress-bar"), GTK_IS_PROGRESS_BAR (_tmp11_) ? ((GtkProgressBar*) _tmp11_) : NULL)), _g_object_unref0 (self->progress), _tmp12_);
#line 152 "ease-import-widget.vala"
	self->spinner = (_tmp13_ = g_object_ref_sink ((GtkSpinner*) gtk_spinner_new ()), _g_object_unref0 (self->spinner), _tmp13_);
#line 153 "ease-import-widget.vala"
	gtk_widget_set_visible ((GtkWidget*) self->spinner, TRUE);
#line 154 "ease-import-widget.vala"
	gtk_widget_set_size_request ((GtkWidget*) self->spinner, EASE_IMPORT_WIDGET_SPINNER_SIZE, EASE_IMPORT_WIDGET_SPINNER_SIZE);
#line 155 "ease-import-widget.vala"
	self->spinner_container = (_tmp15_ = _g_object_ref0 ((_tmp14_ = gtk_builder_get_object (builder, "spin-align"), GTK_IS_WIDGET (_tmp14_) ? ((GtkWidget*) _tmp14_) : NULL)), _g_object_unref0 (self->spinner_container), _tmp15_);
#line 156 "ease-import-widget.vala"
	gtk_container_add ((GtkContainer*) (_tmp16_ = self->spinner_container, GTK_IS_BIN (_tmp16_) ? ((GtkBin*) _tmp16_) : NULL), (GtkWidget*) self->spinner);
#line 159 "ease-import-widget.vala"
	self->icons = (_tmp18_ = _g_object_ref0 ((_tmp17_ = gtk_builder_get_object (builder, "icon-view"), GTK_IS_ICON_VIEW (_tmp17_) ? ((GtkIconView*) _tmp17_) : NULL)), _g_object_unref0 (self->icons), _tmp18_);
#line 160 "ease-import-widget.vala"
	self->icons_container = (_tmp20_ = _g_object_ref0 ((_tmp19_ = gtk_builder_get_object (builder, "icon-window"), GTK_IS_WIDGET (_tmp19_) ? ((GtkWidget*) _tmp19_) : NULL)), _g_object_unref0 (self->icons_container), _tmp20_);
#line 161 "ease-import-widget.vala"
	g_signal_connect_object (self->icons, "selection-changed", (GCallback) __lambda77__gtk_icon_view_selection_changed, self, 0);
#line 166 "ease-import-widget.vala"
	self->no_results = (_tmp22_ = _g_object_ref0 ((_tmp21_ = gtk_builder_get_object (builder, "no-results"), GTK_IS_WIDGET (_tmp21_) ? ((GtkWidget*) _tmp21_) : NULL)), _g_object_unref0 (self->no_results), _tmp22_);
#line 169 "ease-import-widget.vala"
	root = _g_object_ref0 ((_tmp23_ = gtk_builder_get_object (builder, "root"), GTK_IS_EVENT_BOX (_tmp23_) ? ((GtkEventBox*) _tmp23_) : NULL));
#line 170 "ease-import-widget.vala"
	g_signal_connect_object ((GtkWidget*) root, "expose-event", (GCallback) _ease_import_widget_set_bg_gtk_widget_expose_event, self, 0);
#line 171 "ease-import-widget.vala"
	gtk_container_add ((GtkContainer*) self, (GtkWidget*) root);
#line 174 "ease-import-widget.vala"
	g_signal_connect_object (self->priv->service, "started", (GCallback) __lambda78__ease_plugin_import_service_started, self, 0);
#line 187 "ease-import-widget.vala"
	g_signal_connect_object (self->priv->service, "proxy-call-complete", (GCallback) __lambda79__ease_plugin_import_service_proxy_call_complete, self, 0);
#line 193 "ease-import-widget.vala"
	g_signal_connect_object (self->priv->service, "no-results", (GCallback) __lambda80__ease_plugin_import_service_no_results, self, 0);
#line 197 "ease-import-widget.vala"
	g_signal_connect_object (self->priv->service, "loading-started", (GCallback) __lambda81__ease_plugin_import_service_loading_started, self, 0);
#line 207 "ease-import-widget.vala"
	g_signal_connect_object (self->priv->service, "loading-progress", (GCallback) __lambda82__ease_plugin_import_service_loading_progress, self, 0);
#line 211 "ease-import-widget.vala"
	g_signal_connect_object (self->priv->service, "loading-complete", (GCallback) __lambda83__ease_plugin_import_service_loading_complete, self, 0);
#line 568 "ease-import-widget.c"
	_g_object_unref0 (root);
	_g_object_unref0 (builder);
	return self;
}


#line 88 "ease-import-widget.vala"
EaseImportWidget* ease_import_widget_new (EasePluginImportService* serv) {
#line 88 "ease-import-widget.vala"
	return ease_import_widget_construct (EASE_TYPE_IMPORT_WIDGET, serv);
#line 579 "ease-import-widget.c"
}


#line 216 "ease-import-widget.vala"
static gboolean ease_import_widget_set_bg (EaseImportWidget* self, GtkWidget* root, GdkEventExpose* event) {
#line 585 "ease-import-widget.c"
	gboolean result = FALSE;
	GdkColor color;
	guint _tmp0_;
#line 216 "ease-import-widget.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 216 "ease-import-widget.vala"
	g_return_val_if_fail (root != NULL, FALSE);
#line 219 "ease-import-widget.vala"
	color = gtk_widget_get_style (root)->bg[GTK_STATE_NORMAL];
#line 222 "ease-import-widget.vala"
	if ((color.red * EASE_IMPORT_WIDGET_DARK_FACTOR) > 65535) {
#line 224 "ease-import-widget.vala"
		color.red = (guint16) (color.red / EASE_IMPORT_WIDGET_DARK_FACTOR);
#line 225 "ease-import-widget.vala"
		color.blue = (guint16) (color.blue / EASE_IMPORT_WIDGET_DARK_FACTOR);
#line 226 "ease-import-widget.vala"
		color.green = (guint16) (color.green / EASE_IMPORT_WIDGET_DARK_FACTOR);
#line 603 "ease-import-widget.c"
	} else {
#line 232 "ease-import-widget.vala"
		color.red = (guint16) (color.red * EASE_IMPORT_WIDGET_DARK_FACTOR);
#line 233 "ease-import-widget.vala"
		color.blue = (guint16) (color.blue * EASE_IMPORT_WIDGET_DARK_FACTOR);
#line 234 "ease-import-widget.vala"
		color.green = (guint16) (color.green * EASE_IMPORT_WIDGET_DARK_FACTOR);
#line 611 "ease-import-widget.c"
	}
#line 238 "ease-import-widget.vala"
	gtk_widget_modify_bg (root, GTK_STATE_NORMAL, &color);
#line 241 "ease-import-widget.vala"
	g_signal_parse_name ("expose-event", GTK_TYPE_WIDGET, &_tmp0_, NULL, FALSE);
#line 241 "ease-import-widget.vala"
	g_signal_handlers_disconnect_matched (root, G_SIGNAL_MATCH_ID | G_SIGNAL_MATCH_FUNC | G_SIGNAL_MATCH_DATA, _tmp0_, 0, NULL, (GCallback) _ease_import_widget_set_bg_gtk_widget_expose_event, self);
#line 619 "ease-import-widget.c"
	result = FALSE;
#line 243 "ease-import-widget.vala"
	return result;
#line 623 "ease-import-widget.c"
}


static void ease_import_widget_class_init (EaseImportWidgetClass * klass) {
	ease_import_widget_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (EaseImportWidgetPrivate));
	G_OBJECT_CLASS (klass)->finalize = ease_import_widget_finalize;
	/**
	 * Triggers a media add.
	 */
	g_signal_new ("add_media", EASE_TYPE_IMPORT_WIDGET, G_SIGNAL_RUN_LAST, 0, NULL, NULL, g_cclosure_marshal_VOID__OBJECT, G_TYPE_NONE, 1, GEE_TYPE_QUEUE);
}


static void ease_import_widget_instance_init (EaseImportWidget * self) {
	self->priv = EASE_IMPORT_WIDGET_GET_PRIVATE (self);
}


static void ease_import_widget_finalize (GObject* obj) {
	EaseImportWidget * self;
	self = EASE_IMPORT_WIDGET (obj);
	_g_object_unref0 (self->icons);
	_g_object_unref0 (self->icons_container);
	_g_object_unref0 (self->search);
	_g_object_unref0 (self->button);
	_g_object_unref0 (self->insert);
	_g_object_unref0 (self->progress);
	_g_object_unref0 (self->spinner);
	_g_object_unref0 (self->spinner_container);
	_g_object_unref0 (self->no_results);
	_g_object_unref0 (self->extra_widget);
	_g_object_unref0 (self->priv->service);
	G_OBJECT_CLASS (ease_import_widget_parent_class)->finalize (obj);
}


GType ease_import_widget_get_type (void) {
	static volatile gsize ease_import_widget_type_id__volatile = 0;
	if (g_once_init_enter (&ease_import_widget_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (EaseImportWidgetClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) ease_import_widget_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (EaseImportWidget), 0, (GInstanceInitFunc) ease_import_widget_instance_init, NULL };
		GType ease_import_widget_type_id;
		ease_import_widget_type_id = g_type_register_static (GTK_TYPE_ALIGNMENT, "EaseImportWidget", &g_define_type_info, 0);
		g_once_init_leave (&ease_import_widget_type_id__volatile, ease_import_widget_type_id);
	}
	return ease_import_widget_type_id__volatile;
}




